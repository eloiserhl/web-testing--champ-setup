# forms.py
from django import forms
from .models import (
    Championship, Round, Class, Race, ClassSchedule,
    PricingTier, ClassPricing, RaceClass
)

class ChampionshipForm(forms.ModelForm):
    class Meta:
        model = Championship
        fields = ['name']

class RoundForm(forms.ModelForm):
    class Meta:
        model = Round
        fields = ['name', 'date', 'championship']

class ClassForm(forms.ModelForm):
    class Meta:
        model = Class
        fields = ['name', 'base_price']

class RaceForm(forms.ModelForm):
    class Meta:
        model = Race
        fields = ['name', 'round']

class ClassScheduleForm(forms.ModelForm):
    class Meta:
        model = ClassSchedule
        fields = ['rider_class', 'round']

class PricingTierForm(forms.ModelForm):
    class Meta:
        model = PricingTier
        fields = ['name', 'round', 'start_date', 'end_date']

class ClassPricingForm(forms.ModelForm):
    class Meta:
        model = ClassPricing
        fields = ['pricing_tier', 'rider_class', 'price']

class RaceClassForm(forms.ModelForm):
    class Meta:
        model = RaceClass
        fields = ['race', 'rider_class']

# views.py
from django.shortcuts import render, redirect
from .forms import *
from .models import *


def create_entity(request, form_class, template_name, redirect_name):
    if request.method == 'POST':
        form = form_class(request.POST)
        if form.is_valid():
            form.save()
            return redirect(redirect_name)
    else:
        form = form_class()
    return render(request, template_name, {'form': form})


def create_championship(request):
    return create_entity(request, ChampionshipForm, 'create.html', 'create_championship')

def create_round(request):
    return create_entity(request, RoundForm, 'create.html', 'create_round')

def create_class(request):
    return create_entity(request, ClassForm, 'create.html', 'create_class')

def create_race(request):
    return create_entity(request, RaceForm, 'create.html', 'create_race')

def create_class_schedule(request):
    return create_entity(request, ClassScheduleForm, 'create.html', 'create_class_schedule')

def create_pricing_tier(request):
    return create_entity(request, PricingTierForm, 'create.html', 'create_pricing_tier')

def create_class_pricing(request):
    return create_entity(request, ClassPricingForm, 'create.html', 'create_class_pricing')

def create_race_class(request):
    return create_entity(request, RaceClassForm, 'create.html', 'create_race_class')

# urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('championship/create/', views.create_championship, name='create_championship'),
    path('round/create/', views.create_round, name='create_round'),
    path('class/create/', views.create_class, name='create_class'),
    path('race/create/', views.create_race, name='create_race'),
    path('class_schedule/create/', views.create_class_schedule, name='create_class_schedule'),
    path('pricing_tier/create/', views.create_pricing_tier, name='create_pricing_tier'),
    path('class_pricing/create/', views.create_class_pricing, name='create_class_pricing'),
    path('race_class/create/', views.create_race_class, name='create_race_class'),
]

# templates/create.html
<!-- All forms share this one template -->
<!DOCTYPE html>
<html>
<head>
    <title>Create</title>
</head>
<body>
    <h1>Create Entry</h1>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">Save</button>
    </form>
    <a href="/">Back to dashboard</a>
</body>
</html>

